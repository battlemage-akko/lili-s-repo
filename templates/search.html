{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>搜索结果</title>
    <link rel="shortcut icon" href="{% static 'images/search.png' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'css/root.css' %}" rel="stylesheet">
    <link href="{% static 'css/topbar.css' %}" rel="stylesheet">
    <link href="{% static 'css/search.css' %}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <style>
        body {
            background-color: var(--Background-color);
            overflow-x: hidden;
            transition: all .5s ease;
        }
        .videos-top-search{
            display: none;
        }
    </style>
</head>
<body>
    <div id="app">
        {% include 'topbar.html' %}
        <div class="search-container">
            <div class="search-content">
                <ul class="search-content-search">
                        <li style="position: relative;">
                        </li>
                        <li class="search-content-search-container">
                            <input type="text" placeholder="搜索" class="search-content-search-input" v-model="q" @focus="inputActive" @blur="inputActive">
                            <i class="search-content-search-btn" @mousedown="search"></i>
                            <i class="search-content-search-cancel" @mousedown="clear"></i>
                        </li>
                    </ul>
                <div class="search-result">
                <ul class="search-result-user">
                    <li v-for="(item,index) in result.user.exactness">
                        <div>
                            <img :src="true == true?'{% static "images/" %}'+result.user.exactness[0].picture:'{% static "images/default.jpg" %}'" alt="">
                            <span class="search-result-user-name-follow">+关注</span>
                        </div>
                        <div style="display: flex;flex-direction: column;justify-content: center;flex-grow: 1">
                            <div class="search-result-user-info">
                            <div>
                                <div class="search-result-user-name">
                                <h2 class="search-result-user-name-name">{[ result.user.exactness[0].username ]}</h2>
                            </div>
                            <div class="search-result-user-other">
                                <p>{[ result.user.exactness[0].v_count  ]} 投稿</p>
                                <p>|</p>
                                <p>{[ result.user.exactness[0].fans ]} 粉丝</p>
                            </div>
                            <div class="search-result-user-desc">
                                {[ result.user.exactness[0].desc ]}
                            </div>
                                <ul class="search-result-user-videos">
                                    <li v-for="(item,index) in result.user.exactness[0].videos" class="search-result-user-videos-each">
                                        <div :style="{'background-image': 'url({% static 'videos/videopic/' %}'+item.v_pic+')','background-size':'cover'}" class="search-result-user-videos-each-back" @click="jumpbyV_id(item.v_id)">
                                            <span class="search-result-user-videos-each-time">
                                                <span>{[ Math.floor(item.v_duaring/60)<10?"0"+Math.floor(item.v_duaring/60):Math.floor(item.v_duaring/60) ]}:{[ item.v_duaring%60<10?"0"+item.v_duaring%60:item.v_duaring%60 ]}</span>
                                            </span>
                                        </div>
                                        <div class="search-result-user-videos-info">
                                            <div>
                                                <div>《{[item.v_title]}》</div>
                                            </div>
                                            <div>
                                                <div>player : {[item.v_play]}</div>
                                                <div>table : {[ item.v_time.v_time_year ]}-{[ item.v_time.v_time_month ]}-{[ item.v_time.v_time_day ]}</div>
                                            </div>
                                        </div>

                                    </li>
                                </ul>

                            </div>
                        </div>
                            <div style="display: flex;justify-content: center;cursor: pointer;padding-top: 10px">
                                <span class="search-result-user-toprofile">点击进入他的空间</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            </div>
        </div>
    </div>
</body>
<script>
    const vm = new Vue({
        el: "#app",
        delimiters: ['{[', ']}'],
        data:{
            q:"",
            video_url:"{% url "index" %}"+"video/",
            base_url:"{% url 'index' %}"+"search?q=",
            result:{{ result|safe }},
        },
        methods:{
            jumpbyV_id(v_id){
                window.open(this.video_url+v_id)
            },
            inputActive(){
                document.querySelector(".search-content-search-container").classList.toggle("active")
            },
            search(){
                window.location.href = this.base_url + this.q
            },
            clear(){
                this.q=""
            },
        },
        mount:{},
        watch:{},
    })
</script>
</html>